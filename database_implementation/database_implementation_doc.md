# Documentation for the Code

This Python script demonstrates the creation and management of a simple in-memory SQLite database for a customer loyalty and rewards system. The script includes the creation of tables, insertion of sample data, and the generation of a real-time dashboard using `matplotlib` to visualize transaction volumes, reward points, and profitability trends.

---

## **1. Overview**

The script performs the following tasks:
1. **Database Setup**: Creates an in-memory SQLite database with multiple tables to manage customers, vendors, transactions, reward policies, analytics, reward allocations, and products.
2. **Sample Data Insertion**: Populates the tables with sample data for demonstration purposes.
3. **Data Visualization**: Generates a real-time dashboard using `matplotlib` to visualize:
   - Transaction volumes per vendor.
   - Reward points issued vs. redeemed per vendor.
   - Profitability trends (revenue minus rewards) per vendor.

---

## **2. Database Schema**

The database consists of the following tables:

### **2.1 Customers**
- Stores customer information.
- Columns:
  - `customer_id` (Primary Key): Unique identifier for the customer.
  - `name`: Customer's name.
  - `email`: Customer's email (unique).
  - `phone`: Customer's phone number (unique).
  - `wallet_balance`: Customer's wallet balance.
  - `created_at`: Timestamp when the customer was created.
  - `updated_at`: Timestamp when the customer was last updated.

### **2.2 Vendors**
- Stores vendor information.
- Columns:
  - `vendor_id` (Primary Key): Unique identifier for the vendor.
  - `name`: Vendor's name.
  - `category`: Vendor's category (`small`, `medium`, or `large`).
  - `location`: Vendor's location.
  - `created_at`: Timestamp when the vendor was created.
  - `updated_at`: Timestamp when the vendor was last updated.

### **2.3 Transactions**
- Stores transaction details.
- Columns:
  - `transaction_id` (Primary Key): Unique identifier for the transaction.
  - `customer_id`: Foreign key referencing the customer.
  - `vendor_id`: Foreign key referencing the vendor.
  - `amount`: Transaction amount.
  - `reward_points`: Reward points earned in the transaction.
  - `timestamp`: Timestamp of the transaction.

### **2.4 RewardPolicies**
- Stores reward policies for different vendor categories.
- Columns:
  - `policy_id` (Primary Key): Unique identifier for the policy.
  - `category`: Vendor category (`small`, `medium`, or `large`).
  - `threshold`: Minimum transaction amount to earn rewards.
  - `reward_percentage`: Percentage of the transaction amount awarded as reward points.
  - `redeemable_percentage`: Percentage of reward points that can be redeemed.

### **2.5 Analytics**
- Stores analytics data for vendors.
- Columns:
  - `analytics_id` (Primary Key): Unique identifier for the analytics record.
  - `vendor_id`: Foreign key referencing the vendor.
  - `popular_product`: Most popular product for the vendor.
  - `total_transactions`: Total number of transactions for the vendor.
  - `total_revenue`: Total revenue generated by the vendor.
  - `updated_at`: Timestamp when the analytics were last updated.

### **2.6 RewardAllocations**
- Stores reward points allocated to customers.
- Columns:
  - `allocation_id` (Primary Key): Unique identifier for the reward allocation.
  - `customer_id`: Foreign key referencing the customer.
  - `transaction_id`: Foreign key referencing the transaction.
  - `reward_points`: Reward points allocated.
  - `redeemed_points`: Reward points redeemed.
  - `timestamp`: Timestamp of the reward allocation.

### **2.7 Products**
- Stores product details.
- Columns:
  - `product_id` (Primary Key): Unique identifier for the product.
  - `product_name`: Name of the product.
  - `customer_id`: Foreign key referencing the customer who purchased the product.
  - `vendor_id`: Foreign key referencing the vendor selling the product.
  - `transaction_id`: Foreign key referencing the transaction.
  - `price`: Price of the product.
  - `timestamp`: Timestamp of the product purchase.
  - `location`: Location where the product was purchased.
  - `frequency_of_buying`: Frequency of buying the product.

---

## **3. Functions**

### **3.1 `display_table(cursor, table_name)`**
- Displays the contents of a specified table in a formatted manner using the `tabulate` library.
- Parameters:
  - `cursor`: SQLite database cursor.
  - `table_name`: Name of the table to display.

### **3.2 `get_transaction_volumes()`**
- Retrieves the number of transactions per vendor.
- Returns:
  - A list of tuples containing `vendor_id` and the count of transactions.

### **3.3 `get_reward_points_issued_and_redeemed()`**
- Retrieves the total reward points issued and redeemed per vendor.
- Returns:
  - A list of tuples containing `vendor_id`, total reward points issued, and total reward points redeemed.

### **3.4 `get_profitability()`**
- Retrieves the total revenue and total rewards per vendor.
- Returns:
  - A list of tuples containing `vendor_id`, total revenue, and total rewards.

### **3.5 `plot_transaction_volumes(vendor_data)`**
- Plots a bar chart of transaction volumes per vendor.
- Parameters:
  - `vendor_data`: Data returned by `get_transaction_volumes()`.

### **3.6 `plot_reward_points(vendor_data)`**
- Plots a grouped bar chart of reward points issued vs. redeemed per vendor.
- Parameters:
  - `vendor_data`: Data returned by `get_reward_points_issued_and_redeemed()`.

### **3.7 `plot_profitability(vendor_data)`**
- Plots a line chart of profitability trends (revenue minus rewards) per vendor.
- Parameters:
  - `vendor_data`: Data returned by `get_profitability()`.

### **3.8 `real_time_dashboard()`**
- Generates a real-time dashboard with three subplots:
  1. Transaction volumes per vendor.
  2. Reward points issued vs. redeemed per vendor.
  3. Profitability trends per vendor.

---

## **4. Sample Data**

The script inserts sample data into all tables for demonstration purposes. The data includes:
- 5 customers.
- 5 vendors.
- 5 transactions.
- 5 reward policies.
- 5 analytics records.
- 5 reward allocations.
- 5 products.

---

## **5. Visualization**

The `real_time_dashboard()` function generates a dashboard with three visualizations:
1. **Transaction Volumes**: Bar chart showing the number of transactions per vendor.
2. **Reward Points Issued vs. Redeemed**: Grouped bar chart comparing reward points issued and redeemed per vendor.
3. **Profitability Trends**: Line chart showing profitability (revenue minus rewards) per vendor.

---

## **6. Dependencies**

The script requires the following Python libraries:
- `sqlite3`: For database operations.
- `datetime`: For timestamp generation.
- `tabulate`: For displaying table data in a formatted manner.
- `matplotlib`: For generating visualizations.
- `numpy`: For numerical operations (used in plotting).

Install the required libraries using:
```bash
pip install tabulate matplotlib numpy
```

---

## **7. Usage**

1. Run the script to create the in-memory SQLite database and populate it with sample data.
2. The script will display the contents of all tables in the console.
3. A real-time dashboard will be generated using `matplotlib` to visualize transaction volumes, reward points, and profitability trends.

---

## **8. Notes**

- The database is in-memory and will be lost when the script ends.
- The sample data is static and can be modified to test different scenarios.
- The visualizations are basic and can be customized further based on requirements.

---

## **9. Conclusion**

This script provides a basic framework for managing a customer loyalty and rewards system using SQLite and Python. It demonstrates how to create and query a database, as well as how to visualize data using `matplotlib`. The code can be extended to include more complex queries, additional visualizations, or integration with a persistent database.
